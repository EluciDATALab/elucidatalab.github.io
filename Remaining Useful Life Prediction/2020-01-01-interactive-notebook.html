<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">



            <meta name="author" content="ELUCIDATALAB" />


            <meta name="description" content="" />

                <meta property="og:type" content="article" />
            <meta name="twitter:card" content="summary"/>

        <meta name="keywords" content=", Remaining Useful Life Prediction, "/>

        <link rel="canonical" href="/Remaining Useful Life Prediction/2020-01-01-interactive-notebook.html">
    <meta property="og:title" content="Interactive notebook | EluciDATA Lab"/>
    <meta property="og:url" content="/Remaining Useful Life Prediction/2020-01-01-interactive-notebook.html" />
    <meta property="og:description" content="" />
    <meta property="og:site_name" content="EluciDATA Lab" />
    <meta property="og:article:author" content="ELUCIDATALAB" />
        <meta property="og:article:published_time" content="2020-01-01T00:00:00+01:00" />
    <meta name="twitter:title" content="Interactive notebook | EluciDATA Lab">
    <meta name="twitter:description" content="">
        <meta property="og:image" content="/../Remaining Useful Life Prediction/img/general_interactive_clipart.png" />
        <meta name="twitter:image" content="/../Remaining Useful Life Prediction/img/general_interactive_clipart.png" >


        <title>    Interactive notebook  | EluciDATA Lab
</title>

                <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
                <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
				<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
            <link rel="stylesheet" type="text/css" href="/theme/css/custom.css" media="screen">
            <link rel="stylesheet" type="text/css" href="/theme/css/ipynb.css" media="screen">

            <style>
                #progressBar::-webkit-progress-value {
                    background-color: #24292e;
                }
                #progressBar::-moz-progress-bar {
                    background-color: #24292e;
                }
            </style>

        <link href="/theme/libs/prism.css" rel="stylesheet" />
<script type="text/x-mathjax-config">

MathJax.Hub.Config({
tex2jax: { inlineMath: [["$","$"],["\\(","\\)"]] },
"HTML-CSS": {
  linebreaks: { automatic: true, width: "container" }
}
});

</script>
<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

        <link rel="shortcut icon" href="/theme/img/favicon.ico" type="image/x-icon" />
		<link rel="icon" href="/theme/img/apple-touch-icon-152x152.png" type="image/png" />
        <link rel="apple-touch-icon" href="/theme/img/apple-touch-icon.png"  type="image/png" />
        <link rel="apple-touch-icon" sizes="57x57" href="/theme/img/apple-touch-icon-57x57.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="72x72" href="/theme/img/apple-touch-icon-72x72.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="76x76" href="/theme/img/apple-touch-icon-76x76.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="114x114" href="/theme/img/apple-touch-icon-114x114.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="120x120" href="/theme/img/apple-touch-icon-120x120.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="144x144" href="/theme/img/apple-touch-icon-144x144.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="152x152" href="/theme/img/apple-touch-icon-152x152.png" type="image/png" />
    </head>
    <body>
<progress id="progressBar" max="19827" class="flat">
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>
</progress>        <div class="banner-wrapper row" style="background-color: #24292e;">
            <div class="banner">
                <nav id="navbar" class="navbar navbar-expand-md navbar-light bg-light container">
                    <div class="container navbar-title">
                        <a href="/"><img id="banner-logo" src="/theme/img/profile_photo_white.png" style="height: 40px; margin: 6px 0;"></a>
                        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                <div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent" style="margin-bottom: 6.5px;margin-top: 6.5px">
                    <ul class="navbar-nav">
                        <li class="nav-item active">
                            <a class="nav-link rem_08" href="/home.html">Home</a>
                        </li>
                    </ul>
                    <ul class="navbar-nav">
                        <li class="nav-item active">
                            <a class="nav-link rem_08" href="/blog.html">Blog</a>
                        </li>
                    </ul>
                    <ul class="navbar-nav">
                        <li class="nav-item active">
                            <a class="nav-link rem_08" href="/skits.html">Starterkits</a>
                        </li>
                    </ul>
                    <ul class="navbar-nav">
                        <li class="nav-item active">
                            <a class="nav-link rem_08" href="/about.html">About</a>
                        </li>
                    </ul>
                    <ul class="navbar-nav">
                        <li id="second-item" class="nav-item">
                            <a class="nav-link rem_08" href="/archives.html">Archive</a>
                        </li>
                     </ul>
                    <ul class="navbar-nav">
                    <form id="search-form" class="form-inline my-2 my-lg-0 justify-content-center" action="/search.html">
                        <div id="third-item" class="search-box-div row" style="margin-top:-3.5px;">
                            <input id="tipue_search_input" class="form-control mr-md-2 rem_08 col-9" type="text" name="q" pattern=".{3,}" title="At least 3 characters" required="" aria-label="Search"/>
                            <button id="search-btn" class="btn btn-search btn-outline-success btn-circle rem_08 col-3" type="submit" for="tipue_search_input" style="margin-left: 3px;">Search</button>
                        </div>
                    </form>
                    </ul>
                </div>
                </nav>
            </div>
        </div>
        <div id="wrap">
<div id="post-container" class="container post index">
    <article>
        <header class="pop-over">
            <h1>Interactive notebook</h1>
            <div class="row justify-content-between no-margin">
                <h4 class="article-category">Category > <a class="article-category-link" href="/archives.html">Remaining Useful Life Prediction</a></h4>
                <span class="article-date">Wed 01 January 2020</span>
            </div>
            <div class="meta meta-tag no-margin no-border">
                <div>
                </div>
            </div>
            <section>
    <div class="row justify-content-end mt-3" style="align-items: center">
        <div class="share-post-intro mr-2">Share This Post :</div>
        <div class="social-share-btns-container">
            <div class="social-share-btns">
                <a class="share-btn share-btn-twitter" href="https://twitter.com/intent/tweet?text=Interactive%20notebook&url=https%3A//elucidatalab.github.io/Remaining%20Useful%20Life%20Prediction/2020-01-01-interactive-notebook.html" rel="nofollow" target="_blank">
                    <i class="fab fa-twitter"></i>
                </a>
                <a class="share-btn share-btn-facebook" href="http://www.facebook.com/sharer/sharer.php?u=https%3A//elucidatalab.github.io/Remaining%20Useful%20Life%20Prediction/2020-01-01-interactive-notebook.html" rel="nofollow" target="_blank">
                    <i class="fab fa-facebook-f"></i>
                </a>
                <a class="share-btn share-btn-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A//elucidatalab.github.io/Remaining%20Useful%20Life%20Prediction/2020-01-01-interactive-notebook.html&title=Interactive%20notebook&summary=&source=https%3A//elucidatalab.github.io/Remaining%20Useful%20Life%20Prediction/2020-01-01-interactive-notebook.html" rel="nofollow" target="_blank">
                    <i class="fab fa-linkedin-in"></i>
                </a>
            </div>
        </div>
    </div>
</section>

        </header>
        <div class="article_content">
            <p id="list-of-translations">
This post is also available in:
    <a href="/Resource demand Forecasting/2020-01-01-interactive-notebook.html">en</a> and    <a href="/Time Series Preprocessing/2020-01-01-interactive-notebook.html">en</a></p>

            <!--[![Open In AWS](https://upload.wikimedia.org/wikipedia/commons/thumb/9/93/Amazon_Web_Services_Logo.svg/64px-Amazon_Web_Services_Logo.svg.png)](http://3.124.12.58/hub/login){:target="\_blank"}

#### Instructions for AWS
1. Log in with your username and password
2. Access folder **resource_demand_forecasting**
3. Open file **elucidata_demonstrator_1_3_interactive.ipynb**
4. Select Cell > **Run all** to run all code cells
-->

<style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}





.rendered_html pre,




.rendered_html tr,
.rendered_html th,


.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,


.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] 
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">register</span>
<span class="kn">import</span> <span class="nn">cufflinks</span> <span class="k">as</span> <span class="nn">cf</span>
<span class="n">cf</span><span class="o">.</span><span class="n">go_offline</span><span class="p">(</span><span class="n">connected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cf</span><span class="o">.</span><span class="n">set_config_file</span><span class="p">(</span><span class="n">colorscale</span><span class="o">=</span><span class="s1">'plotly'</span><span class="p">,</span> <span class="n">world_readable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Markdown</span><span class="p">,</span> <span class="n">display</span>
<span class="k">def</span> <span class="nf">printmd</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">starterkits.visualization</span> <span class="kn">import</span> <span class="n">vis_plotly_widgets</span> <span class="k">as</span> <span class="n">vpw</span>
<span class="kn">import</span> <span class="nn">visualizations</span> <span class="k">as</span> <span class="nn">v</span>
<span class="kn">import</span> <span class="nn">support</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">from</span> <span class="nn">support</span> <span class="kn">import</span> <span class="n">LstmApp</span><span class="p">,</span> <span class="n">get_test_scores</span>

<span class="c1"># Fixing the used seeds for reproducibility of the experiments</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>  
<span class="n">PYTHONHASHSEED</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">"<style>.container { width:95% !important; }</style>"</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_html rendered_html output_subarea">
<script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        if (typeof require !== 'undefined') {
        require.undef("plotly");
        requirejs.config({
            paths: {
                'plotly': ['https://cdn.plot.ly/plotly-2.4.2.min']
            }
        });
        require(['plotly'], function(Plotly) {
            window._Plotly = Plotly;
        });
        }
        </script>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_html rendered_html output_subarea">
<script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        if (typeof require !== 'undefined') {
        require.undef("plotly");
        requirejs.config({
            paths: {
                'plotly': ['https://cdn.plot.ly/plotly-2.4.2.min']
            }
        });
        require(['plotly'], function(Plotly) {
            window._Plotly = Plotly;
        });
        }
        </script>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_html rendered_html output_subarea">
<script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        if (typeof require !== 'undefined') {
        require.undef("plotly");
        requirejs.config({
            paths: {
                'plotly': ['https://cdn.plot.ly/plotly-2.4.2.min']
            }
        });
        require(['plotly'], function(Plotly) {
            window._Plotly = Plotly;
        });
        }
        </script>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/hcab/opt/miniconda3/lib/python3.7/site-packages/dash_bootstrap_components/table.py:1: UserWarning:


The dash_html_components package is deprecated. Please replace
`import dash_html_components as html` with `from dash import html`

</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_html rendered_html output_subarea">
<script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        if (typeof require !== 'undefined') {
        require.undef("plotly");
        requirejs.config({
            paths: {
                'plotly': ['https://cdn.plot.ly/plotly-2.4.2.min']
            }
        });
        require(['plotly'], function(Plotly) {
            window._Plotly = Plotly;
        });
        }
        </script>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_html rendered_html output_subarea">
<style>.container { width:95% !important; }</style>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Starter-Kit-1.2.1:-Remaining-useful-life-estimation">Starter Kit 1.2.1: Remaining useful life estimation<a class="anchor-link" href="#Starter-Kit-1.2.1:-Remaining-useful-life-estimation">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Business-context">Business context<a class="anchor-link" href="#Business-context">¶</a></h2><p>Maintenance is an important part of an asset's lifecycle. In the past, corrective and preventive maintenance were the norm:</p>
<ul>
<li><em>corrective</em> maintenance was performed when an asset had failed and involved tasks for identifying the fault and rectifying it so that the asset could resume normal operation</li>
<li><em>preventive</em> maintenance was performed to avoid asset failure and involved executing maintenance tasks at regular intervals, e.g. when an asset was used for a certain period of time or when it executed a pre-determined number of cycles.</li>
</ul>
<p>Nowadays, ever more assets are equipped with sensors and ever more data is gathered. This data can be exploited to realize <em>predictive</em> maintenance, which promises costs saving over corrective or preventive maintenance because maintenance is only performed when warranted. Predictive maintenance encompasses a variety of topics, such as failure prediction, remaining useful lifetime estimation (RUL), failure detection, failure diagnosis (root cause analysis) and recommendation of mitigation or maintenance actions after failure.</p>
<h2 id="Business-goal">Business goal<a class="anchor-link" href="#Business-goal">¶</a></h2><p>The business goal addressed by this Starter Kit is the <strong>estimation of the remaining useful lifetime</strong> of an asset. 'Lifetime' in this context is expressed in terms of the evolution of a particular quantity, such as the distance travelled, fuel consumed, repetition cycles performed, number of transactions experienced, etc. Estimating the remaining useful lifetime is non-trivial, as it is influenced by a multitude of internal and external factors, e.g. operating conditions, weather conditions, usage scenarios, etc.</p>
<h2 id="Application-contexts">Application contexts<a class="anchor-link" href="#Application-contexts">¶</a></h2><p>Estimating the remaining useful lifetime of an asset can be beneficial for several purposes in a variety of industrial contexts, for example:</p>
<ul>
<li>to better schedule maintenance operations, e.g. for offshore wind turbines, for which maintenance can only be performed under the right weather conditions.</li>
<li>to optimise the operational efficiency of an asset, by more optimally planning the use of that asset before its end of life, or adapting its operational use to extend its useful lifetime.</li>
<li>to avoid unplanned downtime, e.g. in manufacturing settings, where a downtime of the production line results in several operational problems and associated costs.</li>
<li>to anticipate and avoid safety-critical situations, e.g. for aircrafts or vehicles.</li>
<li>...</li>
</ul>
<h2 id="Data-characteristics-and-requirements">Data characteristics and requirements<a class="anchor-link" href="#Data-characteristics-and-requirements">¶</a></h2><p>Typically, the data to be exploited for remaining useful lifetime estimation has the following characteristics:</p>
<ul>
<li>it consists of time-series data, in particular for the quantity used to express the lifetime of the asset but also for all the factors that influence that quantity (e.g. weather and operating conditions).</li>
<li>temporal patterns such as trends, cycles, seasonality, day/night or week/weekend patterns can be present in the data.</li>
<li>random fluctuation (noise) can also be present, as a result of random variation or unexplained causes. In a large number of cases the data is measured using sensors, therefore some noise is inherently present on the measured signal.</li>
</ul>
<p>Moreover, the following requirements are imposed on the dataset:</p>
<ul>
<li>a sufficiently large amount of historical data needs to be available. Two aspects are important in this respect:<ul>
<li>the implicit assumption is that an asset has a continuous degradation pattern, which is reflected in the asset's sensor measurements. Degradation is often slow, however, so the monitoring period should be sufficiently long so as to include a clear presence of the degradation pattern. </li>
<li>a sufficient number of examples of assets that reached their end of life needs to be present. </li>
</ul>
</li>
<li>the data needs to include explicit information on when an asset has reached its end of life or should allow to easily derive it (e.g. the lifetime quantity has reached a particular threshold). </li>
</ul>
<h2 id="Starter-Kit-outline">Starter Kit outline<a class="anchor-link" href="#Starter-Kit-outline">¶</a></h2><p>The data-driven approach for remaining useful life estimation will be illustrated on the industrially-relevant use case of <strong>predicting the remaining useful lifetime of aircraft engines based on run-to-failure data</strong>.  We will use this dataset to illustrate:</p>
<ul>
<li>How to appropriately preprocess the data and construct training, test and validation sets to learn and evaluate a model able to predict whether an engine will fail within a certain number of operational cycles.</li>
<li>How to use deep learning to construct a model for remaining useful lifetime prediction. In particular, we apply a deep learning approach that uses short-term memory (<a href="https://en.wikipedia.org/wiki/Long_short-term_memory">LSTM</a>) networks and allows the construction of a predictive model without the time-consuming feature engineering step, which requires one to manually extract the characteristics from which the algorithm can learn.</li>
<li>How to experimentally validate the resulting model and objectively compare it with other approaches.</li>
</ul>
<p>The resulting model achieves a high accuracy. The approach is simple and flexible enough to be applied to a wide range of RUL problems.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-understanding">Data understanding<a class="anchor-link" href="#Data-understanding">¶</a></h2><p>The time series data we will use in this Starter Kit is simulated run-to-failure data from aircraft engines. Engines in the data are assumed to start with varying degrees of wear and manufacturing variation. This information is unknown to the user. Furthermore, in this simulated data, engines are assumed to be operating normally at the beginning, and start to degrade at some point during operation. The degradation progresses and grows in magnitude. When a predefined threshold is reached, the engine is considered unsafe for further operation. In other words, the last operational cycle of the engine can be considered as the failure point of the corresponding engine.</p>
<p>In machine learning experiments, a dataset is often split into a training set and a test set, which allows one to quickly evaluate the performance of an algorithm on the problem at hand. The training dataset is used to prepare a model, to train it. We pretend the test dataset is new, unseen data where the output values (in this case, whether or not a specific engine is going to fail within a predefined number of cycles) are withheld from the algorithm.</p>
<p>We gather predictions from the trained model on the inputs from the test dataset and compare them to the withheld output values of the test set, the so-called <em>ground truth</em>. Comparing the predictions and withheld outputs on the test dataset allows us to compute a performance measure for the model on the test dataset. This is an estimate of the skill of the algorithm trained on the problem when making predictions on unseen data.</p>
<p>For this reason, the dataset is divided into three parts, namely the training, test and ground truth datasets:</p>
<ul>
<li>The <em>training data</em> will be used by the algorithm to learn the prediction model. It consists of multiple time series with "cycle" as the time unit, and 21 sensor readings for each cycle. Each sequence of cycles can be assumed as being generated from a different engine (identified by the engine ID) of the same type. Since the algorithm needs to be able to learn when the engine will fail, <strong>the last time period does represent the failure point</strong>. </li>
<li>The <em>test data</em> has the same data schema as the training data and is used to test the quality of the resulting model. The only difference is that the data does not indicate when the failure occurs, or put differently, the last time period does not represent the failure point. </li>
<li>The <em>ground truth data</em> provides the number of remaining working cycles for the engines in the test data, which will only be used to assess the quality of the results, but will not be given as input to the learned model.</li>
</ul>
<p>More details on this dataset can be found in [1].</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_df</span><span class="p">,</span> <span class="n">test_df</span><span class="p">,</span> <span class="n">truth_df</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The table below shows an excerpt of the training data, with the following attributes:</p>
<ul>
<li>id: the identifier of the engine</li>
<li>cycle: the current cycle of the engine from which the data in the respective row is originating, i.e. the current flight of the aircraft</li>
<li>setting 1-3: the values of 3 different operational settings of the engine, e.g. an operational setting could correspond to a cruise setting when the aircraft is flying at cruise speed</li>
<li>s1-21: 21 sensor readings monitoring various parameters of the engine, e.g. temperature or vibration</li>
</ul>
<p>Since the input file is space-separated, and two spurious spaces appear at the end of each line, we remove the last two columns.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[4]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>id</th>
<th>cycle</th>
<th>setting1</th>
<th>setting2</th>
<th>setting3</th>
<th>s1</th>
<th>s2</th>
<th>s3</th>
<th>s4</th>
<th>s5</th>
<th>...</th>
<th>s12</th>
<th>s13</th>
<th>s14</th>
<th>s15</th>
<th>s16</th>
<th>s17</th>
<th>s18</th>
<th>s19</th>
<th>s20</th>
<th>s21</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>2</td>
<td>0.0019</td>
<td>-0.0003</td>
<td>100.0</td>
<td>518.67</td>
<td>642.15</td>
<td>1591.82</td>
<td>1403.14</td>
<td>14.62</td>
<td>...</td>
<td>522.28</td>
<td>2388.07</td>
<td>8131.49</td>
<td>8.4318</td>
<td>0.03</td>
<td>392</td>
<td>2388</td>
<td>100.0</td>
<td>39.00</td>
<td>23.4236</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>3</td>
<td>-0.0043</td>
<td>0.0003</td>
<td>100.0</td>
<td>518.67</td>
<td>642.35</td>
<td>1587.99</td>
<td>1404.20</td>
<td>14.62</td>
<td>...</td>
<td>522.42</td>
<td>2388.03</td>
<td>8133.23</td>
<td>8.4178</td>
<td>0.03</td>
<td>390</td>
<td>2388</td>
<td>100.0</td>
<td>38.95</td>
<td>23.3442</td>
</tr>
<tr>
<th>2</th>
<td>1</td>
<td>4</td>
<td>0.0007</td>
<td>0.0000</td>
<td>100.0</td>
<td>518.67</td>
<td>642.35</td>
<td>1582.79</td>
<td>1401.87</td>
<td>14.62</td>
<td>...</td>
<td>522.86</td>
<td>2388.08</td>
<td>8133.83</td>
<td>8.3682</td>
<td>0.03</td>
<td>392</td>
<td>2388</td>
<td>100.0</td>
<td>38.88</td>
<td>23.3739</td>
</tr>
<tr>
<th>3</th>
<td>1</td>
<td>5</td>
<td>-0.0019</td>
<td>-0.0002</td>
<td>100.0</td>
<td>518.67</td>
<td>642.37</td>
<td>1582.85</td>
<td>1406.22</td>
<td>14.62</td>
<td>...</td>
<td>522.19</td>
<td>2388.04</td>
<td>8133.80</td>
<td>8.4294</td>
<td>0.03</td>
<td>393</td>
<td>2388</td>
<td>100.0</td>
<td>38.90</td>
<td>23.4044</td>
</tr>
<tr>
<th>4</th>
<td>1</td>
<td>6</td>
<td>-0.0043</td>
<td>-0.0001</td>
<td>100.0</td>
<td>518.67</td>
<td>642.10</td>
<td>1584.47</td>
<td>1398.37</td>
<td>14.62</td>
<td>...</td>
<td>521.68</td>
<td>2388.03</td>
<td>8132.85</td>
<td>8.4108</td>
<td>0.03</td>
<td>391</td>
<td>2388</td>
<td>100.0</td>
<td>38.98</td>
<td>23.3669</td>
</tr>
</tbody>
</table>
<p>5 rows × 26 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The test data looks similar to the training data, with the difference that it does not indicate when the failure occurs, or put differently, the last time period does not represent the failure point. Taking the sample test data shown in the table below as an example, the engine with id=1 runs from cycle 1 through cycle 31. It is not shown how many more cycles this engine can last before it fails.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_df</span><span class="p">[</span><span class="mi">25</span><span class="p">:</span><span class="mi">31</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[5]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>id</th>
<th>cycle</th>
<th>setting1</th>
<th>setting2</th>
<th>setting3</th>
<th>s1</th>
<th>s2</th>
<th>s3</th>
<th>s4</th>
<th>s5</th>
<th>...</th>
<th>s12</th>
<th>s13</th>
<th>s14</th>
<th>s15</th>
<th>s16</th>
<th>s17</th>
<th>s18</th>
<th>s19</th>
<th>s20</th>
<th>s21</th>
</tr>
</thead>
<tbody>
<tr>
<th>25</th>
<td>1</td>
<td>27</td>
<td>-0.0007</td>
<td>0.0001</td>
<td>100.0</td>
<td>518.67</td>
<td>642.08</td>
<td>1586.65</td>
<td>1400.31</td>
<td>14.62</td>
<td>...</td>
<td>521.82</td>
<td>2388.02</td>
<td>8127.24</td>
<td>8.4494</td>
<td>0.03</td>
<td>392</td>
<td>2388</td>
<td>100.0</td>
<td>38.87</td>
<td>23.3931</td>
</tr>
<tr>
<th>26</th>
<td>1</td>
<td>28</td>
<td>0.0022</td>
<td>0.0005</td>
<td>100.0</td>
<td>518.67</td>
<td>641.93</td>
<td>1594.25</td>
<td>1401.29</td>
<td>14.62</td>
<td>...</td>
<td>521.84</td>
<td>2388.07</td>
<td>8134.89</td>
<td>8.4470</td>
<td>0.03</td>
<td>392</td>
<td>2388</td>
<td>100.0</td>
<td>38.83</td>
<td>23.3502</td>
</tr>
<tr>
<th>27</th>
<td>1</td>
<td>29</td>
<td>0.0014</td>
<td>0.0001</td>
<td>100.0</td>
<td>518.67</td>
<td>641.95</td>
<td>1587.15</td>
<td>1398.11</td>
<td>14.62</td>
<td>...</td>
<td>522.39</td>
<td>2388.07</td>
<td>8133.13</td>
<td>8.4212</td>
<td>0.03</td>
<td>392</td>
<td>2388</td>
<td>100.0</td>
<td>39.02</td>
<td>23.3621</td>
</tr>
<tr>
<th>28</th>
<td>1</td>
<td>30</td>
<td>-0.0025</td>
<td>0.0004</td>
<td>100.0</td>
<td>518.67</td>
<td>642.79</td>
<td>1585.72</td>
<td>1400.97</td>
<td>14.62</td>
<td>...</td>
<td>521.78</td>
<td>2388.10</td>
<td>8134.79</td>
<td>8.4110</td>
<td>0.03</td>
<td>391</td>
<td>2388</td>
<td>100.0</td>
<td>39.09</td>
<td>23.4069</td>
</tr>
<tr>
<th>29</th>
<td>1</td>
<td>31</td>
<td>-0.0006</td>
<td>0.0004</td>
<td>100.0</td>
<td>518.67</td>
<td>642.58</td>
<td>1581.22</td>
<td>1398.91</td>
<td>14.62</td>
<td>...</td>
<td>521.79</td>
<td>2388.06</td>
<td>8130.11</td>
<td>8.4024</td>
<td>0.03</td>
<td>393</td>
<td>2388</td>
<td>100.0</td>
<td>38.81</td>
<td>23.3552</td>
</tr>
<tr>
<th>30</th>
<td>2</td>
<td>1</td>
<td>-0.0009</td>
<td>0.0004</td>
<td>100.0</td>
<td>518.67</td>
<td>642.66</td>
<td>1589.30</td>
<td>1407.16</td>
<td>14.62</td>
<td>...</td>
<td>521.62</td>
<td>2388.14</td>
<td>8129.59</td>
<td>8.4283</td>
<td>0.03</td>
<td>392</td>
<td>2388</td>
<td>100.0</td>
<td>39.00</td>
<td>23.3923</td>
</tr>
</tbody>
</table>
<p>6 rows × 26 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The ground truth data provides the number of remaining working cycles for the engines in the test dataset. Taking the sample ground truth data shown in the following table as an example, the engine with id 1 in the test data can run for another 112 cycles before it fails.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">truth_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">truth_df</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_html rendered_html output_subarea">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>112</th>
</tr>
</thead>
<tbody>
<tr>
<th>1</th>
<td>98</td>
</tr>
<tr>
<th>2</th>
<td>69</td>
</tr>
<tr>
<th>3</th>
<td>82</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-preprocessing">Data preprocessing<a class="anchor-link" href="#Data-preprocessing">¶</a></h2><p>Before we can start training a model to predict the RUL, a number of preparatory steps needs to be taken.</p>
<ol>
<li><p>As could be seen from the training data sample above, currenly the data does not include a column indicating the RUL, which is the target value we want to predict. As the algorithm needs this information to learn from, the first step will be to create such a column.</p>
</li>
<li><p>A second observation that can be made on the training data sample is that the scale of the values differs across columns. This difference could cause problems when the model needs to calculate the similarity between different cycles (i.e., the rows in the table) during modeling. To address this problem, we will normalise the data. The goal of normalisation is to change the values of the numeric columns in the dataset, in order to have a common scale and avoid distorting differences in the ranges of values or losing information. The normalised values maintain the general distribution and ratios in the source data, while keeping values within a scale applied across all numeric columns used in the model.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="RUL-label-creation">RUL label creation<a class="anchor-link" href="#RUL-label-creation">¶</a></h4><p>The first preprocessing step is to generate a label indicating the Remaining Useful Lifetime. In this Starter Kit, we will not predict the exact number of remaining cycles the engine still has left before failure, yet rather try answering the question 'Is a specific engine going to fail within <em>w1</em> cycles?', where <em>w1</em> is a predefined threshold used during the label creation process.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Training-data">Training data<a class="anchor-link" href="#Training-data">¶</a></h5><p>In order to determine the remaining number of cycles at each time point, the maximum number of cycles per engine is first determined. Subsequently, the current cycle number is substracted from the max number of cycles to obtain the number of cycles remaining at a particular time point. In the following sample, the column <code>RUL</code> indicates the remaining number of cycles for that particular point in time (i.e. the row).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">rul</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)[</span><span class="s1">'cycle'</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">rul</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'max'</span><span class="p">]</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">rul</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">'id'</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">)</span>
<span class="n">train_df</span><span class="p">[</span><span class="s1">'RUL'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="s1">'max'</span><span class="p">]</span> <span class="o">-</span> <span class="n">train_df</span><span class="p">[</span><span class="s1">'cycle'</span><span class="p">]</span>
<span class="n">train_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'max'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Xtrain</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">train_df</span><span class="p">[[</span><span class="s1">'id'</span><span class="p">,</span><span class="s1">'cycle'</span><span class="p">,</span><span class="s1">'RUL'</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[7]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>id</th>
<th>cycle</th>
<th>RUL</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>2</td>
<td>190</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>3</td>
<td>189</td>
</tr>
<tr>
<th>2</th>
<td>1</td>
<td>4</td>
<td>188</td>
</tr>
<tr>
<th>3</th>
<td>1</td>
<td>5</td>
<td>187</td>
</tr>
<tr>
<th>4</th>
<td>1</td>
<td>6</td>
<td>186</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to arrive to a binary label indicating whether an engine is going to fail within <em>w1</em> cycles, the next step is to test whether the number of remaining cycles in the <em>RUL</em> column is smaller than or equal to the predefined threshold <em>w1</em>, currently set to 30 cycles. This is illustrated in the sample below, where for the first row, the value in the column <code>RUL_label</code> is 1, because the engine will fail within 4 cycles.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">w1</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">train_df</span><span class="p">[</span><span class="s1">'RUL_label'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">RUL</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o"><=</span> <span class="n">w1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">train_df</span><span class="p">[[</span><span class="s1">'id'</span><span class="p">,</span><span class="s1">'cycle'</span><span class="p">,</span><span class="s1">'RUL'</span><span class="p">,</span><span class="s1">'RUL_label'</span><span class="p">]]</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[8]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>id</th>
<th>cycle</th>
<th>RUL</th>
<th>RUL_label</th>
</tr>
</thead>
<tbody>
<tr>
<th>20625</th>
<td>100</td>
<td>196</td>
<td>4</td>
<td>1</td>
</tr>
<tr>
<th>20626</th>
<td>100</td>
<td>197</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<th>20627</th>
<td>100</td>
<td>198</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<th>20628</th>
<td>100</td>
<td>199</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>20629</th>
<td>100</td>
<td>200</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Test-data">Test data<a class="anchor-link" href="#Test-data">¶</a></h5><p>A similar approach is adopted for the test set. Note that, in order to generate the labels for the test data, we need to use the ground truth dataset, because the test data does not indicate when the failure occurs, or put differently, the last time period does not represent the failure point.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Generate column max for test data</span>
<span class="n">rul</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)[</span><span class="s1">'cycle'</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">rul</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'max'</span><span class="p">]</span>
<span class="n">truth_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'more'</span><span class="p">]</span>
<span class="n">truth_df</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span> <span class="o">=</span> <span class="n">truth_df</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">truth_df</span><span class="p">[</span><span class="s1">'max'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rul</span><span class="p">[</span><span class="s1">'max'</span><span class="p">]</span> <span class="o">+</span> <span class="n">truth_df</span><span class="p">[</span><span class="s1">'more'</span><span class="p">]</span>
<span class="n">truth_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'more'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Generate RUL for test data</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">truth_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">'id'</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">)</span>
<span class="n">test_df</span><span class="p">[</span><span class="s1">'RUL'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="s1">'max'</span><span class="p">]</span> <span class="o">-</span> <span class="n">test_df</span><span class="p">[</span><span class="s1">'cycle'</span><span class="p">]</span>
<span class="n">test_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'max'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Generate label columns RUL and RUL_label for test data</span>
<span class="n">test_df</span><span class="p">[</span><span class="s1">'RUL_label'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">test_df</span><span class="p">[</span><span class="s1">'RUL'</span><span class="p">]</span> <span class="o"><=</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span> <span class="p">)</span>
<span class="n">test_df</span><span class="p">[[</span><span class="s1">'id'</span><span class="p">,</span><span class="s1">'cycle'</span><span class="p">,</span><span class="s1">'RUL'</span><span class="p">,</span><span class="s1">'RUL_label'</span><span class="p">]];</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Normalisation-using-Min-Max-scaling">Normalisation using Min-Max scaling<a class="anchor-link" href="#Normalisation-using-Min-Max-scaling">¶</a></h4><p>As explained before, the goal of <em>normalisation</em> is to change the values of numeric columns in the dataset to a common scale. In this notebook, to put it simply, normalisation is performed to avoid variables on a higher scale affecting the outcome in bigger measure only because they are on a higher scale.</p>
<p>One of the most popular normalisation technique is <em>Min-Max normalisation</em>, which we also use here. It scales the values of a variable to a range between 0 and 1 using the following formula, where $X$ represents the value to be normalised, $X_{min}$ is the minimum value of the variable in that column and $X_{max}$ is the maximum value for that variable:</p>
<p>$X_{norm} = \frac{X - X_{min}}{X_{max} - X_{min}}$</p>
<p>Note: an alternative approach to Min-Max scaling is Z-score normalisation (or <em>standardisation</em>) in which the variables will be rescaled so that they have the properties of a standard normal distribution with zero mean and unit variance.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For both the training set and the test set, we normalise all columns except <code>id</code>,<code>cycle</code>, and<code>RUL</code>, as we want to keep the original values for these columns. The following sample shows a portion of the normalised training data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_df</span><span class="p">[</span><span class="s1">'cycle_norm'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="s1">'cycle'</span><span class="p">]</span>
<span class="n">cols_normalize</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">difference</span><span class="p">([</span><span class="s1">'id'</span><span class="p">,</span><span class="s1">'cycle'</span><span class="p">,</span><span class="s1">'RUL'</span><span class="p">])</span>
<span class="n">min_max_scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">norm_train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">min_max_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_df</span><span class="p">[</span><span class="n">cols_normalize</span><span class="p">]),</span> 
                             <span class="n">columns</span><span class="o">=</span><span class="n">cols_normalize</span><span class="p">,</span> 
                             <span class="n">index</span><span class="o">=</span><span class="n">train_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">join_df</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">train_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">cols_normalize</span><span class="p">)]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">norm_train_df</span><span class="p">)</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">join_df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">train_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">'mean'</span><span class="p">,</span><span class="s1">'min'</span><span class="p">,</span><span class="s1">'max'</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[10]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>id</th>
<th>cycle</th>
<th>setting1</th>
<th>setting2</th>
<th>setting3</th>
<th>s1</th>
<th>s2</th>
<th>s3</th>
<th>s4</th>
<th>s5</th>
<th>...</th>
<th>s15</th>
<th>s16</th>
<th>s17</th>
<th>s18</th>
<th>s19</th>
<th>s20</th>
<th>s21</th>
<th>RUL</th>
<th>RUL_label</th>
<th>cycle_norm</th>
</tr>
</thead>
<tbody>
<tr>
<th>mean</th>
<td>51.509016</td>
<td>108.813088</td>
<td>0.499492</td>
<td>0.501975</td>
<td>0.0</td>
<td>0.0</td>
<td>0.443065</td>
<td>0.424747</td>
<td>0.450442</td>
<td>0.0</td>
<td>...</td>
<td>0.451122</td>
<td>0.0</td>
<td>0.434226</td>
<td>0.0</td>
<td>0.0</td>
<td>0.524232</td>
<td>0.546119</td>
<td>107.803829</td>
<td>0.150267</td>
<td>0.298651</td>
</tr>
<tr>
<th>min</th>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr>
<th>max</th>
<td>100.000000</td>
<td>362.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.0</td>
<td>0.0</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.0</td>
<td>...</td>
<td>1.000000</td>
<td>0.0</td>
<td>1.000000</td>
<td>0.0</td>
<td>0.0</td>
<td>1.000000</td>
<td>1.000000</td>
<td>361.000000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
</tbody>
</table>
<p>3 rows × 29 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As can be seen, both the settings variables and the sensor variables now only contain values between 0 and 1.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_df</span><span class="p">[</span><span class="s1">'cycle_norm'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="s1">'cycle'</span><span class="p">]</span>
<span class="n">norm_test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">min_max_scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_df</span><span class="p">[</span><span class="n">cols_normalize</span><span class="p">]),</span> 
                            <span class="n">columns</span><span class="o">=</span><span class="n">cols_normalize</span><span class="p">,</span> 
                            <span class="n">index</span><span class="o">=</span><span class="n">test_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">test_join_df</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="n">test_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">cols_normalize</span><span class="p">)]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">norm_test_df</span><span class="p">)</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">test_join_df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Modeling-and-Analysis">Data Modeling and Analysis<a class="anchor-link" href="#Data-Modeling-and-Analysis">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Traditional machine learning models are usually based on manually extracting distinguishing factors that characterise the phenomenon to be learned using domain expertise (the so-called <em>feature engineering</em> step). This usually makes these models hard to reuse since feature engineering is specific to the problem scenario and the available data, and therefore a labour-intensive process. In contrast, deep learning algorithms can automatically extract the right features from the data, eliminating the need for manual feature engineering. Deep learning refers to machine learning approaches involving artificial neural networks (ANNs) that contain a multitude of so-called hidden layers.</p>
<p>One particular type of ANNs are the Long Short-Term Memory networks, or LSTMs. One critical advantage of LSTMs is their ability to remember information from long-term sequences, which is hard to achieve with traditional feature engineering. When manually engineering features for this problem, one would for example compute the rolling average per windows of 50 cycles. This averaging may however lead to a loss of information due to the smoothing and abstracting of values over such a long period. Instead, using all 50 values as input may provide better results. While performing feature engineering over large window sizes may complicate things for traditional machine learning methods, LSTMs are naturally able to handle larger window sizes and use all the information in the window as input.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Algorithm-specific-data-preparation">Algorithm-specific data preparation<a class="anchor-link" href="#Algorithm-specific-data-preparation">¶</a></h4><p>As a first step in the modeling phase, we will prepare the data to serve as input for the LSTM network.</p>
<p>When using LSTMs in the time-series domain, one important parameter to pick is the sequence length, which is the size of the window within which the LSTMs needs to remember information. This is similar to picking a window size when calculating time series features using a rolling window. The idea of using LSTMs is to let the model extract abstract features from the sequence of sensor values in the window rather than engineering those manually. The expectation is that if there is a pattern in these sensor values within the window prior to failure, the pattern should be extracted and learned by the LSTM.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The window size chosen for the training data set strongly influences the prediction results. In the animation below, you can see how differently the single variables for a given engine behave. Furthermore, the time at which the degradation becomes visible is different for different engines.</p>
<p>When using the initial settings in the animation below, i.e. <code>Variable</code> equals <code>s11</code>, <code>ID</code> equals 1 and <code>period</code> equals 50, we see a comparably short line fluctuating around a constant value. When selecting the IDs 3 and 13 instead and increasing the <code>period</code> to 130 at the same time, one sees a clear deviation from the median value indicated by the horizontal gray dashed line. The deviation for both starts at around index 110. When then additionally selecting the engine with <code>ID</code> 36, the deviation starts already at approximately index 80 and therewith significantly earlier. Further looking at <code>Variable</code> <code>s12</code>, the deviation from the median starts at the same times as for <code>s11</code> for the engines under inspection.</p>
<p>When selecting the training period for the model, we need to take the different start of the deviation into account. Here we need to find a good balance between the two different influences: on the one hand, the longer the training data sequence, the better the results; on the other hand, when selecting a too long training period, it is possible that the model learns that a slight deviation is fine in several engines and will therewith fail in predicting the remaining useful lifetime.</p>
<p>The period length will be used in the remainder of the notebook to calculate the model sequences.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">date_range_slider</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">interactive_plot</span><span class="p">(</span><span class="n">test_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div id="119cc262-40ac-4e6d-b85c-83d42b0e0ac8"></div>
<div class="output_subarea output_widget_view">
<script type="text/javascript">
var element = $('#119cc262-40ac-4e6d-b85c-83d42b0e0ac8');
</script>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "f7783375a1434b788b353b3fb13e63b5", "version_major": 2, "version_minor": 0}
</script>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Based on the figures above, it is very hard to visually spot any trends that are influencial for the remaining useful life, let alone to manually extract features from it. As indicated above, the advantage of deep learning algorithms is that they can automatically extract the right features from the data, eliminating the need for manual feature engineering.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the following, we pick the feature columns (<code>sensor_cols</code>) to use for modelling as well as the columns identifying the single sequences (<code>sequence_cols</code>).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sensor_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test_df</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">pattern</span><span class="o">=</span><span class="s1">'s[0-9]'</span><span class="p">)]</span>
<span class="n">sequence_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'setting1'</span><span class="p">,</span> <span class="s1">'setting2'</span><span class="p">,</span> <span class="s1">'setting3'</span><span class="p">,</span> <span class="s1">'cycle_norm'</span><span class="p">]</span>
<span class="n">sequence_cols</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sensor_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://keras.io/">Keras</a> is a deep learning library written in Python, which naturally interfaces with <a href="https://www.tensorflow.org">TensorFlow</a>, an open-source software library for machine learning. Its <a href="https://keras.io/layers/recurrent/">LSTM</a> layer expects an input in the shape of a 3-dimensional matrix of (samples, time steps, features) (more specifically a 3-dimensional <a href="https://www.numpy.org">NumPy</a> array) where 'samples' is the number of training sequences, 'time steps' is the look back window or sequence length and 'features' is the number of features of each sequence at each time step. During this transformation, we also select the columns from the input data that can serve as features. In this case, we selected all sensor values, as well as the 3 settings parameters and the (normalised) current cycle the machine is in at this point.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">gen_sequence</span><span class="p">(</span><span class="n">id_df</span><span class="p">,</span> <span class="n">seq_length</span><span class="p">,</span> <span class="n">seq_cols</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Function to reshape the data into a 3-dimensional (samples, time steps, features) matrix </span>
<span class="sd">    """</span>
    <span class="n">data_array</span> <span class="o">=</span> <span class="n">id_df</span><span class="p">[</span><span class="n">seq_cols</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">num_elements</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_elements</span><span class="o">-</span><span class="n">seq_length</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">seq_length</span><span class="p">,</span> <span class="n">num_elements</span><span class="p">)):</span>
        <span class="k">yield</span> <span class="n">data_array</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For each <code>id</code> in the data set, a data sequence will be created. As initial sequence length, we will use 50 time steps.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">register</span><span class="p">(</span><span class="n">date_range_slider</span><span class="p">)</span>
<span class="n">sequence_length</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">seq_gen</span> <span class="o">=</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">gen_sequence</span><span class="p">(</span><span class="n">train_df</span><span class="p">[</span><span class="n">train_df</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span><span class="o">==</span><span class="nb">id</span><span class="p">],</span> <span class="n">sequence_length</span><span class="p">,</span> <span class="n">sequence_cols</span><span class="p">))</span> 
           <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">train_df</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

<span class="n">seq_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">seq_gen</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">printmd</span><span class="p">(</span><span class="sa">f</span><span class="s1">'''This results in a 3-dimensional input matrix with </span><span class="si">{</span><span class="n">seq_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> samples, </span>
<span class="si">{</span><span class="n">seq_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1"> time steps and </span><span class="si">{</span><span class="n">seq_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1"> features (including 21 sensor values, </span>
<span class="s1">the 3 settings parameters and the normalised current cycle).'''</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_markdown rendered_html output_subarea">
<p>This results in a 3-dimensional input matrix with 15630 samples, 
50 time steps and 25 features (including 21 sensor values, 
the 3 settings parameters and the normalised current cycle).</p>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the training data, the labels are also added to this data structure, so that the LSTM can learn from it.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">gen_labels</span><span class="p">(</span><span class="n">id_df</span><span class="p">,</span> <span class="n">seq_length</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="n">data_array</span> <span class="o">=</span> <span class="n">id_df</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">num_elements</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_array</span><span class="p">[</span><span class="n">seq_length</span><span class="p">:</span><span class="n">num_elements</span><span class="p">,</span> <span class="p">:]</span>
<span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="n">sequence_length</span> <span class="o">=</span> <span class="n">date_range_slider</span><span class="o">.</span><span class="n">get_interact_value</span><span class="p">()</span>
<span class="n">label_gen</span> <span class="o">=</span> <span class="p">[</span><span class="n">gen_labels</span><span class="p">(</span><span class="n">train_df</span><span class="p">[</span><span class="n">train_df</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">],</span> <span class="n">sequence_length</span><span class="p">,</span> <span class="p">[</span><span class="s1">'RUL_label'</span><span class="p">])</span>
                     <span class="k">for</span> <span class="n">id_</span> <span class="ow">in</span> <span class="n">train_df</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()]</span>
<span class="n">label_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">label_gen</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">v</span><span class="o">.</span><span class="n">plot_label_frequency</span><span class="p">(</span><span class="n">label_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img src="data:image/png;base64,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
"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The majority of data points, roughly 80 %, are labeled as zero, indicating that no failure was observed.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="LSTM-network">LSTM network<a class="anchor-link" href="#LSTM-network">¶</a></h2><p><em>Note: we refer the interested reader to Appendix A for a brief introduction to LSTM networks.</em></p>
<p>In this section, we guide you through the general process of building, training, evaluating and testing a LSTM model. This will be done by means of an interactive interface. In order to see the code used for these steps, please expand the fields below.</p>
<h3 id="Exercise-1">Exercise 1<a class="anchor-link" href="#Exercise-1">¶</a></h3><h4 id="Network-construction">Network construction<a class="anchor-link" href="#Network-construction">¶</a></h4><p>Let us start by building an LSTM network. In our setup, we will experiment with a stacked structure. In order to learn from different architectures of the LSTM model, it is possible to change the model variables in the animation below.</p>
<p>We ask the reader to test different model scenarios by applying the following steps:</p>
<ol>
<li>Select the number of intermediate layers. For the first experiment, please select a single intermediate layer only. </li>
<li>Set the size of the intermediate layer to 30. This corresponds to a rather small network.</li>
<li>Set the number of epochs for training to 15. Epochs define the number of times the model iterates over the training data arrays, the aim being for the model to improve during each training epoch. In general, the more epochs the better the results, until we reach the given model's limit. </li>
<li>Similarly as before, the training sequence length defines the number of data points to take into account for training per engine. Please select a sequence length of 50.</li>
<li>Furthermore, we add a dropout layer after each LSTM layer. The dropout consists in randomly setting a fraction rate of input units to 0 at each update during training time, which helps preventing overfitting. <em>Overfitting</em> means that a model fits too closely a limited set of data points. This typically results in an overly complex model that fits all little details in the data under study. Please choose a value of 0.2 for this first experiment. </li>
</ol>
<h4 id="Model-training">Model training<a class="anchor-link" href="#Model-training">¶</a></h4><p>Now that we have fixed the network design, we can fit the network to the training data by pushing the button <code>Train model</code>. After a successful training, a green badge will appear. 
The fitting step is influenced by the following parameters, which we will keep fixed during our experiments:</p>
<ul>
<li>Batch size: The number of samples that are used per gradient update (while fixing the best parameters for the model). We will use a batch size of 200.</li>
<li>Validation split: fraction of the training data to be used as validation data. The model will set apart this fraction of the training data, will not train on it, and will evaluate the loss and any model metrics on this data at the end of each epoch. We will use a validation split of 5%.</li>
</ul>
<p>Furthermore, the fitting function will stop early if the validation loss (which is the quality criterion that is used to evaluate the model performance) is not decreasing anymore. To parametrise the early stopping function, the following parameters can be handled by TensorFlow:</p>
<ul>
<li>Minimal delta: minimum change in the monitored quantity as given by the validation loss to qualify as an improvement, i.e. an absolute change of less than min_delta will count as no improvement. </li>
<li>Patience: number of epochs with no improvement after which training will be stopped.</li>
</ul>
<p>In the experiments defined in this Starter Kit, we keep both minimal delta and patience at zero.</p>
<h4 id="Model-evaluation-and-testing">Model evaluation and testing<a class="anchor-link" href="#Model-evaluation-and-testing">¶</a></h4><p>Now that we have a fitted model, we can evaluate its performance. We will first evaluate the model performance on the training data and subsequently on the test data. If both evaluations result in approximately the same score, this gives an indication that the model is generalisable to unseen datasets and thus is not overfitting on the training data.</p>
<p>In the interface, please switch to the tab <code>Evaluation</code> at the top and press the button <code>Evaluate model</code>. This will lead to the evaluation of the last trained model. 
The model can be evaluated using different measures. We will on the one hand evaluate the model in function of <em>accuracy</em>, which measures the fraction of all instances that are correctly categorized; it is the ratio of the number of correct classifications to the total number of instances to classify. On the other hand, we will show the so-called <em>confusion matrix</em>. The confusion matrix for the model that we just trained shows that the model is able to correctly classify that a specific engine is not going to fail within w1 cycles for almost all of the 12531 samples. Vice versa, the model is able to correctly classify for almost all of the 3100 cases that a specific engine is going to fail within w1 cycles. \
Based on the confusion matrix, several other measures such as <em>precision</em> and <em>recall</em> can be calculated. Intuitively, precision is the ability of the classifier not to label a sample that is negative as positive. When instantiated for the RUL prediction problem we are currently considering, precision indicates how many of the engines that the model predicted to reach their end of life within 30 cycles also actually reach their end of life within this amount of cycles. Recall is the ability of the classifier to find all the positive samples, i.e., all engines that reach their end of life within 30 cycles. The respective results are given in the model evaluation summary table.</p>
<p>A unique id will be assigned to each evaluated model in order to compare the results for different models. Note that the evaluation is performed on the training data. In order to evaluate it on the test data (that is unknown to the model), please continue to the tab <code>Testing</code>. By pushing the button <code>Evaluate model</code>, the model selected in the dropdown menu is evaluated on the test data.</p>
<h4 id="Questions:">Questions:<a class="anchor-link" href="#Questions:">¶</a></h4><ul>
<li>Is there a significant difference in accuracy when evaluating the model on the validation and test data?</li>
<li>Do you think the model is overfitting?</li>
</ul>
<h3 id="Exercise-2:">Exercise 2:<a class="anchor-link" href="#Exercise-2:">¶</a></h3><p>The LSTM network built in Exercise 1 performs well on the evaluation data set with an accuracy of about 95% but with a lower accuracy on the test data. This gives us a hint that the model might be overfitting on the training data. Therefore, in this second experiment, we add a second LSTM layer to the network. Please increase the number of layers to 2 and set the following layer sizes:</p>
<ul>
<li>Intermediate Layer 1: 200</li>
<li>Intermediate Layer 2: 50</li>
</ul>
<p>Keep the remaining parameters as they are. Subsequently repeat the steps taken in the previous exercise:</p>
<ol>
<li>Train the model</li>
<li>Evaluate it on the validation data</li>
<li>Evaluate it on the test data</li>
</ol>
<h4 id="Questions:">Questions:<a class="anchor-link" href="#Questions:">¶</a></h4><ul>
<li>Which difference do you observe? Compare the results in the tables in both tabs - evaluation and testing</li>
<li>When comparing the two models, which one would you use and why?</li>
</ul>
<h3 id="Exercise-3:">Exercise 3:<a class="anchor-link" href="#Exercise-3:">¶</a></h3><p>Use the interface to experiment with alternative architectures and see how the parameters influence the quality of the model. You can try to answer questions such as:</p>
<ul>
<li>Will the model improve when the number of epochs is increased?</li>
<li>Is it possible to reach an accuracy of 98 % on both data sets (validation and test)?</li>
<li>Does adding a third LSTM layer improve the results even further?</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="LSTM-interface">LSTM interface<a class="anchor-link" href="#LSTM-interface">¶</a></h3><p>Note: if the current port is already in use, change it to any port between 8050 and 8060</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">PORT</span> <span class="o">=</span> <span class="mi">8050</span>
<span class="n">v</span><span class="o">.</span><span class="n">start_dashboard</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">sequence_cols</span><span class="p">,</span> <span class="n">test_df</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Dash app running on http://127.0.0.1:8050
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Code">Code<a class="anchor-link" href="#Code">¶</a></h2><p>In what follows, you can find the most prominent functions that are called in the interactive interface to construct and train the LSTM model, and subsequently evaluate it.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Model-building-and-compilation">Model building and compilation<a class="anchor-link" href="#Model-building-and-compilation">¶</a></h5><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compile_model</span><span class="p">(</span><span class="n">num_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sizes</span><span class="p">):</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Sequential_Layer'</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_layers</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sizes</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span>
                    <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">nb_features</span><span class="p">),</span>
                    <span class="n">units</span><span class="o">=</span><span class="n">sizes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">return_sequences</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">sizes</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span>
                    <span class="n">units</span><span class="o">=</span><span class="n">sizes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">return_sequences</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">sizes</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)))</span>
            <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout</span><span class="p">))</span>

    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="n">nb_out</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'sigmoid'</span><span class="p">))</span>

    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">'binary_crossentropy'</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>
    <span class="k">return</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
<h5 id="Model-training">Model training<a class="anchor-link" href="#Model-training">¶</a></h5><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">seq_array</span><span class="p">,</span> <span class="n">label_array</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
          <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
          <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">'val_loss'</span><span class="p">,</span> <span class="n">min_delta</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)])</span>
</pre></div>
<h5 id="Make-predictions-and-compute-confusion-matrix">Make predictions and compute confusion matrix<a class="anchor-link" href="#Make-predictions-and-compute-confusion-matrix">¶</a></h5><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">seq_array</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">label_array</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Comparison-of-performance-against-other-methods">Comparison of performance against other methods<a class="anchor-link" href="#Comparison-of-performance-against-other-methods">¶</a></h4><p>In order to get an idea of the quality of the LSTM model, we will compare it with the best performing model from [1]. In this experiment, four binary classification models are compared, namely a Two-Class Logistic Regression model, a Two-Class Boosted Decision Tree, a Two-Class Decision Forest, and a Two-Class Neural Network. Note that for these models, a manual feature engineering step was needed, whereas in the case of the LSTM model, the algorithm automatically decides on the most appropriate features.</p>
<p>The table below compares the best performing model, namely a Two-Class Neural Network, with the LSTM approach, in terms of accuracy, precision, recall, and F1-score.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">results_df</span> <span class="o">=</span> <span class="n">get_test_scores</span><span class="p">()</span>
<span class="n">results_df</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[18]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>model id</th>
<th>Accuracy</th>
<th>Precision</th>
<th>Recall</th>
<th>F1-score</th>
</tr>
<tr>
<th>model_type</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>Two-Class Neural Network (best performing model from [1])</th>
<td>-</td>
<td>94.0</td>
<td>0.952381</td>
<td>0.8</td>
<td>0.869565</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion">¶</a></h2><p>In this Starter Kit, we covered the basics of using deep learning for remaining useful life prediction, which is one of the central topics in predictive maintenance. We illustrated the approach on the industrially-relevant use case of predicting the remaining useful lifetime of aircraft engines based on run-to-failure data. In doing so, we have shown:</p>
<ul>
<li>How to appropriately preprocess the data and construct training, validation and test sets to learn and evaluate a model that predicts whether an engine will fail within a certain number of operational cycles.</li>
<li>How to use deep learning to construct a model for remaining useful life prediction. In particular, we applied a deep learning approach called long short-term memory (LSTM) networks which allows the construction of a predictive model without the time-consuming feature engineering step, which requires one to manually extract the characteristics from which the algorithm can learn.</li>
<li>How to experimentally validate the resulting model and objectively compare it with other approaches.</li>
</ul>
<p>Comparing the above results on the test set, we see that the LSTM results are comparable to the results of the best performing model in <a href="#PMT">[1]</a>, with the advantage of not requiring a manual feature engineering step. Furthermore, it should be noted that the data set used here is very small and deep learning models are known to perform better with large datasets, so for a more fair comparison larger datasets should be used. The approach is simple and flexible enough to be applied to a wide range of RUL problems.</p>
<h4 id="Possible-next-steps">Possible next steps<a class="anchor-link" href="#Possible-next-steps">¶</a></h4><p>One of the attention points when working with deep learning techniques is that it is important to tune the models to the right parameters, such as the window size. While the presented approach already gives promising results, quite some improvements are still possible, such as:</p>
<ul>
<li>Trying different window sizes.</li>
<li>Trying different architectures with a different number of layers and nodes.</li>
<li>Trying to tune the hyperparameters of the network.</li>
<li>Trying to cast the RUL prediction problem as a regression or multi-class classification task instead of as a binary classification task.</li>
<li>Trying on a larger dataset with more instances.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Appendix-A:-A-brief-introduction-to-LSTM-networks">Appendix A: A brief introduction to LSTM networks<a class="anchor-link" href="#Appendix-A:-A-brief-introduction-to-LSTM-networks">¶</a></h2><p>In the following, we will briefly explain the intuition behind an LSTM network, yet for a more detailed explanation we refer the interested reader to the original publication <a href="#Hochreiter1997">[2]</a> or more intuitive descriptions (e.g. <a href="#Olah">[3]</a>, <a href="#Yan">[4]</a>).</p>
<p>A single layer LSTM consists of several <em>blocks</em>. Each block takes three inputs: 1) the input of the current time step, 2) the output from the previous LSTM block (of the previous time step) and 3) the "memory" of the previous block. Each block also provides output for the current timestep, and produces an updated memory of the current block. Therefore, a single block makes a decision by considering the current input, previous output and previous memory, generates a new output and alters its memory. This information flow is graphically represented in the following figure (taken from <a href="#Yan">[4]</a>):</p>
<p><img alt="LSTM with multiple blocks (taken from [4])" src="images/LSTM_blocks.png" title="LSTM with multiple blocks (taken from [4]"/></p>
<p>The way the internal memory changes is controlled by different <em>gates</em> that control the information flow. Each gate computes a value between 0 and 1 using a logistic function to compute a value. The data is multiplied by this value to partially allow or deny information to flow into or out of the memory. An <em>input gate</em> controls the extent to which a new value flows into the memory. A <em>forget gate</em> controls the extent to which a value remains in memory. An <em>output gate</em> controls the extent to which the value in memory is used to compute the output activation of the block.</p>
<p>An LSTM thus keeps two pieces of information as it propagates through time:</p>
<ul>
<li><em>A hidden state</em>; which is the memory the LSTM accumulates using its (forget, input, and output) gates through time,</li>
<li><em>The previous time-step output</em>.</li>
</ul>
<p>An important parameter when constructing LSTM networks is the size of the LSTM's hidden state. In the underlying computation framework TensorFlow that is used in this notebook, this parameter is set by the variable <code>num_units</code>. To make the name <code>num_units</code> more intuitive, you can think of it as the number of hidden units in the LSTM block, or the number of memory units in the block.</p>
<p>The explaination above describes the structure of a single LSTM layer. However, an LSTM network usually consists of multiple <em>layers</em>, that can be stacked or merged. In case the layers are stacked, the output of the previous layer serves as input for the next layer.</p>
<p><img alt="Multi-layer LSTM" src="images/multilayerLSTM.png" title="Multi-layer LSTM"/></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="References">References<a class="anchor-link" href="#References">¶</a></h2><ol>
<li><span id="PMT">[Predictive Maintenance Template](https://gallery.cortanaintelligence.com/Collection/Predictive-Maintenance-Template-3)</span></li>
<li><span id="Hochreiter1997">Hochreiter, Sepp, and Jurgen Schmidhuber. "Long short-term memory." Neural computation 9.8 (1997): 1735-1780.</span></li>
<li><span id="Olah">Olah, Christopher. ["Understanding LSTM Networks"](http://colah.github.io/posts/2015-08-Understanding-LSTMs/)</span></li>
<li><span id="Yan">Yan, Shi. ["Understanding LSTM and its diagrams"](https://medium.com/@shiyan/understanding-lstm-and-its-diagrams-37e2f46f1714)</span></li>
<li><span id="MathWorks">MathWorks, ["Models for Predicting Remaining Useful Life"](https://nl.mathworks.com/help/predmaint/ug/models-for-predicting-remaining-useful-life.html)</span></li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Additional-information">Additional information<a class="anchor-link" href="#Additional-information">¶</a></h2><p>This notebook is based on the <a href="https://github.com/Azure/lstms_for_predictive_maintenance">'Deep Learning for Predictive Maintenance' notebook</a> by Fidan Boylu Uz.</p>
<p><em>MIT License</em></p>
<p><em>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</em></p>
<p><em>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</em></p>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
        </div>
        <hr/>
        <aside>
        <nav>
        <ul class="articles-timeline">
            <li class="next-article"><a href="/Remaining Useful Life Prediction/2020-01-01-interactive-notebook.html" title="Next: Interactive notebook">Interactive notebook</a> »</li>
        </ul>
        </nav>
        </aside>
        <hr/>
    </article>
</div>
        </div>
<footer class="footer">
   <div class="container bottom_border">
      <div class="row">
         <div class="col">
            <h5 class="headin5_amrc col_white_amrc pt2">ABOUT EluciDATA Lab</h5>
            <!--headin5_amrc-->
            <p class="mb10"><img id="profile_img" align="left" src="/theme/img/PoweredBySirris_negatif.png"></p>
            <p><i class="fa fa-envelope mr-2"></i>elucidatalab@sirris.be</p>
         </div>
      </div>
   </div>
   <div class="container">
      <ul class="foote_bottom_ul_amrc">
         <li><a href="/">HOME</a></li>
         <li><a href="about.html">ABOUT</a></li>
         <li><a href="archives.html">ARCHIVE</a></li>
      </ul>
      <!--foote_bottom_ul_amrc ends here-->
      <p class="text-center">&copy Sirris <a href="https://elucidata.be/gebruikersovereenkomst">Gebruikersovereenkomst</a> <a href="https://elucidata.be/privacy-policy">Privacy policy</a><br>EluciDATA Lab -The Data and AI Competence Lab of Sirris</p>
      <div class="container">
          <div class="row justify-content-center">
              <div class="row" align="center">
                  <div class="footer-icon"><a href="https://www.linkedin.com/company/sirris/"><i class="fab fa-linkedin-in"></i></a></div>
                  <div class="footer-icon"><a href="https://github.com/orgs/EluciDATALab"><i class="fab fa-github"></i></a></div>
              </div>
          </div>
      </div>

      <!--social_footer_ul ends here-->
   </div>
</footer>
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
            <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

        <script src="/theme/libs/prism.js"></script>
        <script src="/theme/libs/Countable.js"></script>

        <script>
            Prism.plugins.NormalizeWhitespace.setDefaults({
                'remove-trailing': true,
                'remove-indent': true,
                'left-trim': true,
                'right-trim': true,
                /*'break-lines': 80,
                'indent': 2,
                'remove-initial-line-feed': false,
                'tabs-to-spaces': 4,
                'spaces-to-tabs': 4*/
            });
        </script>


        <script type="text/javascript" src="/theme/js/custom.js"></script>
            <script>
                function validateForm(query)
                {
                    return (query.length > 0);
                }
            </script>
    </body>
</html>

